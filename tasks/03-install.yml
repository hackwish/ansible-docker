# Docker for Linux
## Debian based systems
- name: Remove Docker old version
  shell: for pkg in docker.io docker-doc docker-compose docker-compose-v2 podman-docker containerd runc; do sudo apt-get remove -y $pkg; done
  ignore_errors: yes
  when:
    - ansible_os_family == "Debian"

- name: Install Docker package
  package:
    name:
    - docker-ce
    - docker-ce-cli
    - containerd.io
    - docker-buildx-plugin
    - docker-compose-plugin
    state: latest
  register: docker_installed
  tags: docker
  delay: 10
  when:
    - ansible_os_family == "Debian"

- name: Enable and run service
  shell: systemctl enable docker && systemctl start docker
  when:
    - ansible_os_family == "Debian"
    - docker_installed.changed

# Docker for MacOS
- name: Install Docker Bundle from Brew
  homebrew:
    name: "{{ packages }}"
  vars:
    packages:
      - 'boot2docker'
      - 'docker'
      - 'docker-buildx'
      - 'docker-clean'
      - 'docker-completion'
      - 'docker-compose'
      - 'docker-machine'
    state: present
  when:
    - ansible_os_family == "Darwin"
